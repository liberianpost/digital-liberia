{"version":3,"file":"MoeDashboard-177cd31e.js","sources":["../../src/components/MoeDashboard.jsx"],"sourcesContent":["import React, { useEffect, useState, Component } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '@context/AuthContext';\nimport { getAvailableDashboardItems, getDefaultRouteForLevel } from '@utils/dashboardManager';\nimport { getRoleName } from '@utils/auth';\n\nclass ErrorBoundary extends Component {\n  state = { error: null };\n\n  static getDerivedStateFromError(error) {\n    console.error('MoeDashboard.jsx - ErrorBoundary caught:', error, error.stack);\n    return { error };\n  }\n\n  render() {\n    if (this.state.error) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-100 text-gray-900\">\n          <div className=\"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center\">\n            <h1 className=\"text-2xl font-bold mb-4\">Something Went Wrong</h1>\n            <p className=\"text-red-600 mb-6\">{this.state.error.message || 'An unexpected error occurred'}</p>\n            <button\n              onClick={() => window.location.reload()}\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n            >\n              Reload Page\n            </button>\n          </div>\n        </div>\n      );\n    }\n    return this.props.children;\n  }\n}\n\nconst MoeDashboard = () => {\n  const { user, loading, logout } = useAuth() || { user: null, loading: true };\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [currentDate] = useState(new Date());\n\n  useEffect(() => {\n    console.log('MoeDashboard.jsx - useEffect - user:', user, 'loading:', loading, 'location:', location.pathname);\n    if (loading) return;\n    if (!user) {\n      console.log('MoeDashboard.jsx - No user, redirecting to /system');\n      navigate('/system', { replace: true });\n    } else {\n      try {\n        const defaultRoute = getDefaultRouteForLevel(user.securityLevel);\n        if (location.pathname === '/moe/dashboard') {\n          console.log(`MoeDashboard.jsx - Redirecting to ${defaultRoute} for ${user.securityLevel}`);\n          navigate(defaultRoute, { replace: true });\n        }\n      } catch (error) {\n        console.error('MoeDashboard.jsx - Navigation error:', error);\n      }\n    }\n  }, [user, loading, navigate, location.pathname]);\n\n  let availableItems = [];\n  try {\n    availableItems = getAvailableDashboardItems(user?.securityLevel);\n    console.log('MoeDashboard.jsx - Available items:', availableItems);\n  } catch (error) {\n    console.error('MoeDashboard.jsx - Error fetching available items:', error);\n  }\n\n  const handleCardClick = (path) => {\n    console.log('MoeDashboard.jsx - Navigating to:', path);\n    navigate(path);\n  };\n\n  const formatDate = (date) => {\n    try {\n      return date.toLocaleDateString('en-US', {\n        weekday: 'long',\n        month: 'long',\n        day: 'numeric',\n        year: 'numeric',\n      });\n    } catch (error) {\n      console.error('MoeDashboard.jsx - Error formatting date:', error);\n      return 'Date unavailable';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"flex items-center space-x-2\">\n          <svg\n            className=\"animate-spin h-8 w-8 text-gray-600\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n          >\n            <circle\n              className=\"opacity-25\"\n              cx=\"12\"\n              cy=\"12\"\n              r=\"10\"\n              stroke=\"currentColor\"\n              strokeWidth=\"4\"\n            />\n            <path\n              className=\"opacity-75\"\n              fill=\"currentColor\"\n              d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n            />\n          </svg>\n          <span>Loading...</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return null; // Handled by useEffect redirect\n  }\n\n  return (\n    <ErrorBoundary>\n      <div className=\"min-h-screen bg-gray-50 p-6\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"flex justify-between items-center mb-8\">\n            <div className=\"flex items-center space-x-4\">\n              <img\n                src=\"/logos/moe.png\"\n                alt=\"MOE Logo\"\n                className=\"w-16 h-16\"\n                onError={(e) => {\n                  console.error('MoeDashboard.jsx - Failed to load MOE logo');\n                  e.target.src = 'https://via.placeholder.com/64?text=MOE';\n                }}\n              />\n              <div>\n                <h1 className=\"text-2xl font-bold text-gray-800\">\n                  Welcome, {user.username || 'User'}\n                </h1>\n                <p className=\"text-gray-600\">{formatDate(currentDate)}</p>\n              </div>\n            </div>\n            <button\n              onClick={() => {\n                console.log('MoeDashboard.jsx - Logging out:', user);\n                logout();\n                navigate('/system', { replace: true });\n              }}\n              className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700\"\n            >\n              Logout\n            </button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {availableItems.length > 0 ? (\n              availableItems.map((item) => (\n                <div\n                  key={item.id}\n                  onClick={() => handleCardClick(item.path)}\n                  className=\"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer\"\n                >\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-3xl p-3 bg-blue-100 text-blue-600 rounded-full\">\n                      {item.icon}\n                    </div>\n                    <div>\n                      <h2 className=\"text-xl font-semibold\">{item.title}</h2>\n                      <span className=\"text-xs px-2 py-1 bg-blue-600 text-white rounded-full\">\n                        {getRoleName(item.requiredLevel)}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <p className=\"text-gray-600\">No tools available for your role.</p>\n            )}\n          </div>\n        </div>\n      </div>\n    </ErrorBoundary>\n  );\n};\n\nexport default MoeDashboard;\n"],"names":["ErrorBoundary","Component","state","error","getDerivedStateFromError","console","stack","render","jsxs","jsx","message","window","location","reload","props","children","MoeDashboard","user","loading","logout","useAuth","navigate","useNavigate","useLocation","currentDate","useState","Date","useEffect","log","pathname","replace","defaultRoute","getDefaultRouteForLevel","securityLevel","availableItems","getAvailableDashboardItems","handleCardClick","path","formatDate","date","toLocaleDateString","weekday","month","day","year","e","target","src","username","length","map","item","icon","title","getRoleName","requiredLevel","id"],"mappings":"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"}