import{b as y,f as k,u as L,S as C,r as l,e as S,j as e}from"./index-CwYS-J06.js";const M=()=>{const o=y(),{studentId:c}=k(),{user:n}=L(),f=C.SCHOOL_ADMIN,[i,h]=l.useState(null),[t,u]=l.useState({name:"",grade:"",email:"",phone:"",address:""}),[v,m]=l.useState(!0),[a,g]=l.useState(!1),[r,p]=l.useState({});l.useEffect(()=>{!n||!S(f,n==null?void 0:n.securityLevel)?(alert("Access denied. Requires SCHOOL ADMIN privileges."),o("/moe/dashboard",{replace:!0})):(m(!0),api.get(`/students/${c}`).then(s=>{h(s.data),u({name:s.data.name,grade:s.data.grade,email:s.data.email,phone:s.data.phone,address:s.data.address}),m(!1)}).catch(s=>{console.error("Error fetching student:",s),alert("Failed to load student profile."),o(-1),m(!1)}))},[n,c,o]);const b=()=>{const s={};return t.name||(s.name="Full Name is required"),t.grade||(s.grade="Grade is required"),(!t.email||!/\S+@\S+\.\S+/.test(t.email))&&(s.email="Valid email is required"),t.phone||(s.phone="Phone number is required"),t.address||(s.address="Address is required"),p(s),Object.keys(s).length===0},d=s=>{const{name:j,value:N}=s.target;u(x=>({...x,[j]:N})),p(x=>({...x,[j]:""}))},w=async()=>{if(b())try{await api.put(`/students/${c}`,t),h({...i,...t}),g(!1),alert("Profile updated successfully.")}catch(s){console.error("Error updating student:",s),alert("Failed to update student profile.")}};return v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"w-4/5 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"50%"}})})}):i?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white text-black p-4 shadow-md border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>o(-1),className:"mr-4 text-black","aria-label":"Go back",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsx("h1",{className:"text-xl font-bold",children:"Student Profile"})]}),e.jsxs("button",{onClick:a?w:()=>g(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md flex items-center hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),a?"Save":"Edit"]})]})}),e.jsxs("div",{className:"p-4 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex flex-col items-center mb-6",children:e.jsx("img",{src:i.profileImage||"https://via.placeholder.com/120?text=Profile",alt:"Student profile",className:"w-32 h-32 rounded-full mb-2 object-cover",onError:s=>{console.error("Failed to load profile image"),s.target.src="https://via.placeholder.com/120?text=Profile"}})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Basic Information"}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Full Name"}),e.jsxs("div",{className:"mt-1 flex items-center border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:d,disabled:!a,className:"flex-1 outline-none bg-transparent"})]}),r.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Grade"}),e.jsxs("div",{className:"mt-1 flex items-center border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})}),e.jsx("input",{type:"text",name:"grade",value:t.grade,onChange:d,disabled:!a,className:"flex-1 outline-none bg-transparent"})]}),r.grade&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.grade})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Student ID"}),e.jsxs("div",{className:"mt-1 flex items-center border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})}),e.jsx("input",{type:"text",value:i.id,disabled:!0,className:"flex-1 outline-none bg-transparent text-gray-500"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Contact Information"}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Email"}),e.jsxs("div",{className:"mt-1 flex items-center border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:d,disabled:!a,className:"flex-1 outline-none bg-transparent"})]}),r.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Phone"}),e.jsxs("div",{className:"mt-1 flex items-center border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m-2.5 7.5h10M3 9h12m-4 8H3m8.5-5.5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0z"})}),e.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:d,disabled:!a,className:"flex-1 outline-none bg-transparent"})]}),r.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.phone})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Address"}),e.jsxs("div",{className:"mt-1 flex items-start border border-gray-300 rounded-md px-3 py-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("textarea",{name:"address",value:t.address,onChange:d,disabled:!a,rows:2,className:"flex-1 outline-none bg-transparent"})]}),r.address&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.address})]})]})]})]})]}):null};export{M as default};
