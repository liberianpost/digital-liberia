var x=Object.defineProperty;var b=(a,t,o)=>t in a?x(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;var d=(a,t,o)=>(b(a,typeof t!="symbol"?t+"":t,o),o);import{u as p,b as f,a as v,r as i,g as y,e as N,c as r,j as s,f as w}from"./index-D9KMI703.js";class D extends i.Component{constructor(){super(...arguments);d(this,"state",{error:null})}static getDerivedStateFromError(o){return console.error("MoeDashboard.jsx - ErrorBoundary caught:",o,o.stack),{error:o}}render(){return this.state.error?r("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 text-gray-900",children:s("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center",children:[r("h1",{className:"text-2xl font-bold mb-4",children:"Something Went Wrong"}),r("p",{className:"text-red-600 mb-6",children:this.state.error.message||"An unexpected error occurred"}),r("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}const E=()=>{const{user:a,loading:t,logout:o}=p()||{user:null,loading:!0},l=f(),c=v(),[h]=i.useState(new Date);i.useEffect(()=>{if(console.log("MoeDashboard.jsx - useEffect - user:",a,"loading:",t,"location:",c.pathname),!t)if(!a)console.log("MoeDashboard.jsx - No user, redirecting to /system"),l("/system",{replace:!0});else try{const e=y(a.securityLevel);c.pathname==="/moe/dashboard"&&(console.log(`MoeDashboard.jsx - Redirecting to ${e} for ${a.securityLevel}`),l(e,{replace:!0}))}catch(e){console.error("MoeDashboard.jsx - Navigation error:",e)}},[a,t,l,c.pathname]);let n=[];try{n=N(a==null?void 0:a.securityLevel),console.log("MoeDashboard.jsx - Available items:",n)}catch(e){console.error("MoeDashboard.jsx - Error fetching available items:",e)}const g=e=>{console.log("MoeDashboard.jsx - Navigating to:",e),l(e)},m=e=>{try{return e.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})}catch(u){return console.error("MoeDashboard.jsx - Error formatting date:",u),"Date unavailable"}};return t?r("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s("div",{className:"flex items-center space-x-2",children:[s("svg",{className:"animate-spin h-8 w-8 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r("span",{children:"Loading..."})]})}):a?r(D,{children:r("div",{className:"min-h-screen bg-gray-50 p-6",children:s("div",{className:"max-w-6xl mx-auto",children:[s("div",{className:"flex justify-between items-center mb-8",children:[s("div",{className:"flex items-center space-x-4",children:[r("img",{src:"/logos/moe.png",alt:"MOE Logo",className:"w-16 h-16",onError:e=>{console.error("MoeDashboard.jsx - Failed to load MOE logo"),e.target.src="https://via.placeholder.com/64?text=MOE"}}),s("div",{children:[s("h1",{className:"text-2xl font-bold text-gray-800",children:["Welcome, ",a.username||"User"]}),r("p",{className:"text-gray-600",children:m(h)})]})]}),r("button",{onClick:()=>{console.log("MoeDashboard.jsx - Logging out:",a),o(),l("/system",{replace:!0})},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Logout"})]}),r("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.length>0?n.map(e=>r("div",{onClick:()=>g(e.path),className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer",children:s("div",{className:"flex items-center space-x-4",children:[r("div",{className:"text-3xl p-3 bg-blue-100 text-blue-600 rounded-full",children:e.icon}),s("div",{children:[r("h2",{className:"text-xl font-semibold",children:e.title}),r("span",{className:"text-xs px-2 py-1 bg-blue-600 text-white rounded-full",children:w(e.requiredLevel)})]})]})},e.id)):r("p",{className:"text-gray-600",children:"No tools available for your role."})})]})})}):null};export{E as default};
